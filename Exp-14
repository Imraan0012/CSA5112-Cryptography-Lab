def preprocess(text):
    return ''.join(c.upper() for c in text if c.isalpha())

def encrypt_upper(text, key):
    text = preprocess(text)
    return ''.join(
        chr((ord(c) - ord('A') + key[i % len(key)]) % 26 + ord('A'))
        for i, c in enumerate(text)
    )

def recover_key(plaintext, ciphertext):
    plaintext = preprocess(plaintext)
    ciphertext = preprocess(ciphertext)
    key = [(ord(c2) - ord(c1)) % 26 for c1, c2 in zip(plaintext, ciphertext)]
    key.append(0)  # Padding or termination marker
    return key

# Part (a): Encrypt with known key
plaintext_a = "SEND MORE MONEY"
key_a = [4, 2, 15, 25, 12, 7, 11, 14, 11, 1, 1, 4, 11, 11, 0]
ciphertext_a = encrypt_upper(plaintext_a, key_a)

# Part (b): Recover key from known plaintextâ€“ciphertext pair
target_plaintext_b = "CASH NOT NEEDED"
target_ciphertext_b = "GEWJ RSX RIIHIX"
recovered_key = recover_key(target_plaintext_b, target_ciphertext_b)

# Output
print("Part (a):")
print("Plaintext:", preprocess(plaintext_a))
print("Key:", key_a)
print("Ciphertext:", ciphertext_a)

print("\nPart (b):")
print("Target Plaintext:", preprocess(target_plaintext_b))
print("Target Ciphertext:", preprocess(target_ciphertext_b))
print("Recovered Key:", recovered_key)
