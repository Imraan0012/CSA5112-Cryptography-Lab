import numpy as np

def mod_inverse_matrix(matrix, modulus):
    det = int(round(np.linalg.det(matrix)))
    det_inv = pow(det, -1, modulus)
    matrix_mod_inv = (
        det_inv * np.round(det * np.linalg.inv(matrix)).astype(int) % modulus
    )
    return matrix_mod_inv

def text_to_numbers(text):
    return [ord(c) - ord('a') for c in text.lower() if c.isalpha()]

def numbers_to_text(numbers):
    return ''.join(chr(n % 26 + ord('a')) for n in numbers)

def pad_text(text, block_size):
    text = ''.join(c for c in text.lower() if c.isalpha())
    while len(text) % block_size != 0:
        text += 'x'
    return text

def encrypt_hill(plaintext, key):
    block_size = key.shape[0]
    plaintext = pad_text(plaintext, block_size)
    nums = text_to_numbers(plaintext)
    ciphertext = ''
    for i in range(0, len(nums), block_size):
        block = np.array(nums[i:i+block_size])
        enc_block = key.dot(block) % 26
        ciphertext += numbers_to_text(enc_block)
    return ciphertext

def decrypt_hill(ciphertext, key):
    block_size = key.shape[0]
    nums = text_to_numbers(ciphertext)
    key_inv = mod_inverse_matrix(key, 26)
    plaintext = ''
    for i in range(0, len(nums), block_size):
        block = np.array(nums[i:i+block_size])
        dec_block = key_inv.dot(block) % 26
        plaintext += numbers_to_text(dec_block)
    return plaintext

# Example usage
key = np.array([[6, 24, 1],
                [13, 16, 10],
                [20, 17, 15]])

plaintext = "meet me at the usual place at ten rather than eight o'clock"
print("Original plaintext:")
print(plaintext)

ciphertext = encrypt_hill(plaintext, key)
print("\nEncrypted ciphertext:")
print(ciphertext)

decrypted = decrypt_hill(ciphertext, key)
print("\nDecrypted plaintext:")
print(decrypted)
